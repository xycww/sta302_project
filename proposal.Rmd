---
title: "Proposal"
author: "Sakura Hu, Ruikang Wang, Peizeng Yuan"
date: "`r Sys.Date()`"
output: pdf_document
---

# Contributions
Sakura Hu:
Ruikang Wang:
Peizeng Yuan:

# Introduction

# Data Description

# Preliminary Results

# Bibliography

```{r setup, echo=FALSE, warning=FALSE, message=FALSE}
# Set CRAN mirror
options(repos = c(CRAN = "https://cloud.r-project.org/"))
```

```{r}
#| echo: false
#| warning: false
#| message: false

# Install the NHANES package
install.packages("NHANES")

# Load the package
library(NHANES)
library(dplyr)
library(ggplot2)


# View available datasets
data(package = "NHANES")

# Load the main dataset
data(NHANES)

# Select only the columns you need and filter out rows with missing values
nhanes_data <- NHANES %>%
  select(BMI, Poverty, PhysActiveDays, Age, SleepHrsNight, Gender) %>%
  filter(!is.na(BMI), !is.na(Poverty), !is.na(PhysActiveDays), !is.na(Age), !is.na(SleepHrsNight), !is.na(Gender))


# Check the first few rows to make sure everything looks correct
head(nhanes_data)

```

```{r}
#| echo: false
#| warning: false
#| message: false

# Convert Gender to a factor (if not already)
nhanes_data$Gender <- as.factor(nhanes_data$Gender)
# Fit a linear model
lm_model <- lm(log(BMI) ~ Poverty + PhysActiveDays + Age + SleepHrsNight + Gender, data = nhanes_data)

# Summary of the model
summary(lm_model)

```


```{r}
#| echo: false
#| warning: false
#| message: false

fitted_values = fitted(lm_model)
residual_values = resid(lm_model)
     
plot(fitted_values, residual_values, 
     main = "NHANES: fitted versus residual values", 
     xlab = "Fitted", 
     ylab = "Residuals")
```
```{r}
plot(lm_model, which=1)
```

```{r}
fitted_values = fitted(lm_model)
sresidual_values = rstandard(lm_model)
     
plot(fitted_values, sresidual_values, 
     main = "NAHANES: fitted versus Standardized Residuals values", 
     xlab = "Fitted", 
     ylab = "Standardized Residuals")
```
```{r}
plot(lm_model, which=3)
```
```{r}
hist(residual_values,
     main = "Standardized residuals histogram",
     xlab = "Standardized residuals")
```

```{r}
hist(sresidual_values,
     main = "Standardized residuals histogram",
     xlab = "Standardized residuals")
```
```{r}
plot(nhanes_data[, c(7, 2, 3, 4, 5, 6)], col="cadetblue")
```
```{r}
BMI_values = lm_model$log_BMI
fitted_values = fitted(lm_model)

plot(fitted_values, BMI_values,
     main = "BMI versus regression fit",
     xlab = "Fitted values", ylab = "BMI")
abline(0, 1, 
       col=c("blue"), lty=1)
legend("bottomright", legend=c("y = x line"),
       col=c("blue"), lty=1)
```
```{r}
par(mfrow=c(1, 2))
plot(lm_model, which = 1)
plot(lm_model, which = 3)
```
```{r}
par(mfrow=c(1, 2))

hist(rstandard(lm_model),
     main = "Standardized residuals histogram",
     xlab = "Standardized residuals")

plot(fit, which=2)
```
```{r}
# Normal Q-Q plot
plot(lm_model, which = 2)

# Scale-Location plot (homoscedasticity)
plot(lm_model, which = 3)

# Residuals vs Leverage (to check for influential data points)
plot(lm_model, which = 5)

# Scatter plot for continuous variables
ggplot(nhanes_data, aes(x = PhysActiveDays, y = log_BMI)) + geom_point() + geom_smooth(method = "lm", col = "red") + labs(title = "BMI vs PhysActiveDays")

ggplot(nhanes_data, aes(x = Poverty, y = log_BMI)) + geom_point() + geom_smooth(method = "lm", col = "red") + labs(title = "BMI vs Poverty")

# Boxplot for Gender
ggplot(nhanes_data, aes(x = Gender, y = log_BMI)) + geom_boxplot() + labs(title = "BMI vs Gender")

# Boxplot for Gender
ggplot(nhanes_data, aes(x = SleepHrsNight, y = log_BMI)) + geom_point() + geom_smooth(method = "lm", col = "red") + labs(title = "BMI vs Poverty")

# Boxplot for Gender
ggplot(nhanes_data, aes(x = Age, y = log_BMI)) + geom_point() + geom_smooth(method = "lm", col = "red") + labs(title = "BMI vs Poverty")
#correlation matrix, linear regression
```

```{r}
# Plot histograms for each variable
par(mfrow = c(2, 3))  # Arrange plots in 2 rows and 3 columns
hist(nhanes_data$BMI, main="BMI Distribution", xlab="BMI", col="lightblue")
hist(nhanes_data$Poverty, main="Poverty Index Distribution", xlab="Poverty Index", col="lightgreen")
hist(nhanes_data$PhysActiveDays, main="Physical Activity Days Distribution", xlab="Phys Active Days", col="lightcoral")
hist(nhanes_data$Age, main="Age Distribution", xlab="Age", col="lightyellow")
hist(nhanes_data$SleepHrsNight, main="Sleep Hours Distribution", xlab="Sleep Hours", col="lightpink")
hist(as.numeric(nhanes_data$Gender), main="Gender Distribution", xlab="Gender (0=Female, 1=Male)", col="lightgray")
par(mfrow = c(1, 1))  # Reset plot layout
```




